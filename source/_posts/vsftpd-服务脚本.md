title: vsftpd 服务脚本
categories: [Linux,Shell编程]
tags: []
date: 2011-06-20 15:04:00
---
<p>&nbsp;</p><p>#!/bin/bash</p><p>#by:key1088</p><p>#description:vsftpd</p><p>#conf:/etc/vsftpd/vsftp.conf</p><p>#cp vsftpd &nbsp;/etc/init.d/vsftpd</p><p>#chmod 755 /etc/init.d/vsftpd</p><p>#chkconfig --add vsftpd&nbsp;</p><p>#chkconfig vsftpd on</p><p>&nbsp;</p><p>&nbsp;</p><p>if [ -f /etc/init.d/functions ]&nbsp;</p><p>then</p><p>. /etc/init.d/functions</p><p>elif [ -f /etc/rc.d/init.d/functions ]</p><p>then</p><p>. /etc/rc.d/init.d/functions</p><p>else</p><p>exit 0</p><p>fi</p><p>vsftpd=/usr/local/sbin/vsftpd &nbsp; &nbsp; &nbsp;</p><p>ftpconf=/etc/vsftpd/vsftpd.conf</p><p>prog=vsftpd</p><p>RETVAL=0</p><p>start() {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; if [ -n &quot;`/sbin/pidof $prog`&quot; ]</p><p>&nbsp; &nbsp; &nbsp; &nbsp; then</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo &quot;$prog: already running&quot; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return 1</p><p>&nbsp; &nbsp; &nbsp; &nbsp; fi</p><p>&nbsp; &nbsp; &nbsp; &nbsp; echo &quot;Starting $prog:&quot;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; base=$prog</p><p>&nbsp; &nbsp; &nbsp; &nbsp; $vsftpd $ftpconf&amp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; if [ -z &quot;`/sbin/pidof $prog`&quot; ]</p><p>&nbsp; &nbsp; &nbsp; &nbsp; then</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RETVAL=1</p><p>&nbsp; &nbsp; &nbsp; &nbsp; fi</p><p>&nbsp; &nbsp; &nbsp; &nbsp; if [ $RETVAL -ne 0 ] &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; then</p><p>&nbsp; &nbsp; &nbsp; &nbsp; echo &quot;Startup failure&quot;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; else</p><p>&nbsp; &nbsp; &nbsp; &nbsp; echo &quot;Startup success&quot; &nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; fi</p><p>&nbsp; &nbsp; &nbsp; &nbsp; return $RETVAL</p><p>}</p><p>&nbsp;</p><p>stop() {</p><p>if [ -z &quot;`/sbin/pidof $prog`&quot; ]</p><p>then</p><p>RETVAL=1</p><p>fi</p><p>if [ $RETVAL -ne 0 ]</p><p>then</p><p>echo &quot;vsftpd no have run&quot;</p><p>else</p><p>&nbsp; &nbsp; &nbsp; &nbsp; echo &quot;Stopping $prog:&quot;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; killall $vsftpd</p><p>&nbsp; &nbsp; &nbsp; &nbsp; RETVAL=$?</p><p>&nbsp; &nbsp; &nbsp; &nbsp; if [ $RETVAL -ne 0 ]</p><p>&nbsp; &nbsp; &nbsp; &nbsp; then</p><p>&nbsp; &nbsp; &nbsp; &nbsp; echo &quot;Shutdown failure&quot; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; else</p><p>&nbsp; &nbsp; &nbsp; &nbsp; echo &quot;Shutdown success&quot; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; fi</p><p>fi</p><p>}</p><p>&nbsp;</p><p>case &quot;$1&quot; in</p><p>start)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; start &nbsp; &nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ;;</p><p>stop)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; stop &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ;;</p><p>status)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; status $vsftpd</p><p>&nbsp; &nbsp; &nbsp; &nbsp; RETVAL=$? &nbsp; &nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ;;</p><p>restart)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; stop</p><p>&nbsp; &nbsp; &nbsp; &nbsp; start</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ;;</p><p>*)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; echo &quot;Usage: $prog {start|stop|restart|status}&quot;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; exit 1</p><p>esac</p><p>exit $RETVAL</p><br /><p></p>