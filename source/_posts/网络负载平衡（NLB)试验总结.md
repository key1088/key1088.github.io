title: 网络负载平衡（NLB)试验总结
categories: [网络工程]
tags: []
date: 2010-03-28 11:33:00
---
<p>这两天被这个试验忙死了，居然钻错了方向。</p><p>NLB大致分为四个类型：1.单网卡多播</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  2.单网卡单播</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  3.多网卡多播</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  4.多网卡单播</p><p>这是微软官方说的四种NLB类型。我做单播时候，虚拟机环境下没有做出来。每次重启网卡的时候就提示</p><p>Adapter Ethernet0 may not have network connectivity.MAC address 02:BF:C0:A8:05:01 of adapter Ethernet0 is within the reserved address range or is in use by another virtual adapter on your system.</p><p>一次和第二次分别down机时，可以完成冗余，在第三次切换的时候，无法连接，其他的没有问题了。不知道问题出在哪了，感觉应该是虚拟环境的问题。也没有多少技术含量。</p><p>注意一下几点：</p><p>1.使用NLB管理器的时候，应在本机把本机添加到群集中，不用在其他PC上操作本机。</p><p>2.单播群集里，不能进行通信。</p><p>3.NLB聚合后，不一定就意味着成功，自己测试一下。</p><p> </p><p>在做双网卡多播时，发现一下亮点。欢迎就这样的。</p><p>都属于baidu.com域中。节点一为域控，并在上面配置DNS。节点二为域成员。</p><p>AD：192.168.5.106 255.255.255.0  DNS:192.168.5.106</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  10.0.0.1  255.0.0.0 DNS:10.0.0.1</p><p>key；192.168.5.109 255.255.255.0 DNS：192.168.5.106</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  10.0.0.2  255.0.0.0  DNS：10.0.0.1</p><p> </p><p>测试PC：192.168.5.105  255.255.255.0 DNS：192.168.5.106</p><p>并在主机上做了WEB服务。</p><p>用域名访问没有问题。测试时，把AD的节点网卡DOWN掉，竟然能用域名访问，key的web页。我用NSLOOKUP解析，竟然解析不出来。以为是缓存的问题，把缓存清楚后，还可以。难道是key上面两卡的转换，也许就通过10.0.0.0/8网段解析的，那为什么NSLOOKUP不能解析呢，这问题就不多探讨了，当初应该把key的10.0.0.2网卡down掉，验证一下，现在也没有心思做了。</p><p>原理方面就去microsoft吧，地址奉上。</p><p><a href="http://technet.microsoft.com/zh-cn/library/cc784785%28WS.10%29.aspx">http://technet.microsoft.com/zh-cn/library/cc784785%28WS.10%29.aspx</a></p>