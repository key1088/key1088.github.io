title: 构建网络负载平衡(NLB)
categories: [网络工程]
tags: []
date: 2010-03-23 12:46:00
---
<strong>[转]构建网络负载平衡(NLB)</strong>                                                         作者：佚名&#160;&#160;&#160;&#160;厚朴教育来源：<a href="http://ce.sysu.edu.cn/hope/ShowCopyFrom.asp?ChannelID=1007&amp;SourceName=%E4%BD%9A%E5%90%8D">佚 名</a>&#160;&#160;&#160;                                        　　NLB群集允许用户把两台或更多的服务器结合起来使用，在客户端看起来就像是一台服务器。进入NLB群集的连接 请求可以分解传送给两个或更多的NLB群集成员，这样用户可以添加越来越多的服务器(最多32台)，形成一个功能非常强大的FTP站点或Web站点            <p>　　当把一台服务器(包括Web服务器、FTP服务器或者流媒体服务器等等)放入网络中之后，随着客户端数量的不断增  加，人们往往需要功能更强大、处理速度更快的服务器。为了解决这个问题，如果将原有的服务器替换成功能更强大、处理速度更快的服务器显然并不是值得称道的  办法。但是如果能把新服务器添加到原有服务器的处理能力基础上而不是替换它，这种方案毫无疑问更容易被用户接受。网络负载平衡(Network  Load Balancing，NLB)群集的出现正好实现了这一目的。</p> <p>　　NLB群集最早出现在Windows 2000 Server的Advanced Server系统中，在Windows Server  2003的各个版本中均提供了此项功能。NLB群集允许用户把两台或更多的服务器结合起来使用，在客户端看起来就像是一台服务器。进入NLB群集的连接请  求可以分解传送给两个或更多的NLB群集成员，这样用户可以添加越来越多的服务器(最多32台)，形成一个功能非常强大的FTP站点或Web站点。</p> <p>　　在NLB群集中，每台服务器都会有一个属于自己的静态IP地址，但NLB群集中的所有服务器还有一个共同的IP地址—NLB群集地址。客户端可   以通过这个IP地址连接到NLB群集，就像连接到其它IP地址一样。当有客户端请求连接到这个共享的IP地址时，NLB群集会将每个访问请求指派一个具体  的群集成员。</p> <p>　　尽管NLB群集是一种非常简洁的工具，但安装配置NLB群集必须满足很严格的要求，譬如首先要保证群集中服务器必须能够正常的单独运行。以安装 配置两节点的NLB群集为例，这些条件简述如下：</p> <p>　　(1)每个节点服务器必须拥有一个静态IP地址，另外还应该为NLB群集准备一个静态IP地址。</p> <p>　　(2)NLB群集需要拥有一个DNS名称，且该DNS记录项应该与区群集IP地址建立了映射关系。</p> <p>　　(3)每个节点服务器上应该安装完全相同的服务器软件(如IIS、终端服务器等网络服务)，以构成一个两节点的NLB群集。</p> <p>　　在接下来的内容中将介绍如何安装配置一个较为简单的NLB群集—拥有两个节点的Web服务器群集。所要安装配置的服务器群集环境为：两台运行  Windows Server 2003 Enterprise  Edition的服务器，可以将其称为节点1和节点2。由于所有的NLB群集成员必须使用属于相同子网的静态IP地址，因此准备为节点1分配的静态IP地  址为“10.115.223.1”，准备为节点2分配的静态IP地址为“10.1115.223.2”，为NLB群集分配的IP地址是  10.115.223.10。对NLB和配置环境了解之后，现在就可以进行详细的操作了。</p> <p>　　NLB群集中的每一个节点拥有一个静态IP地址是安装配置NLB群集的首要且必要条件。我们首先为节点1进行配置。</p> <p>　　在节点1服务器的桌面上右击“网上邻居”，打开“网络连接”窗口。然后右键单击“本地连接”图标，执行“属性”快捷命令，打开“本地连接  属性”对话框。</p> <p>　　在“本地连接 属性”对话框中双击“Internet 协议(TCP/IP)”选项，打开“Internet 协议(TCP/IP)  属性”对话框。在常规选项卡中点选“使用下面的IP地址”单选框，并指定静态IP地址。本例使用IP地址为“10.115.223.1”，子网掩码为  “255.255.254.0”，默认网关为“10.115.223.254”，DNS服务器地址为“10.115.223.1”(如图1)。</p> <p>　　</p> <p><img width="404" height="443" title="构建网络负载平衡群集(NLB) - 落花往事 - 落花往事" alt="构建网络负载平衡群集(NLB) - 落花往事 - 落花往事" src="http://ce.sysu.edu.cn/hope/Education/UploadFiles_5303/201001/20100113204258559.jpg" /></p> <p>　　图1</p> <p>　　在Windows Server 2003中安装部署Web服务需要IIS 6.0的支持，但是在默认情况下IIS  6.0组件并没有被安装，因此手动安装IIS 6.0组件。</p> <p>　　在“控制面板”中双击“添加或删除程序”图标，在打开的“添加或删除程序”对话框中单击“添加/删除Windows组件”按钮，打开 “Windows组件向导”对话框。</p> <p>　　在“组件”列表中找到并双击“应用程序服务器”复选框，在打开的“应用程序服务器”对话框中双击“Internet信息服务(IIS)”选项，   打开“Internet信息服务(IIS)”对话框。在子组件列表中找到并勾选“万维网服务”复选框，依次单击“确定/确定/下一步”按钮开始安装。最后  单击“完成”按钮结束安装过程(如图2)。</p> <p>　　</p> <p><img width="449" height="345" title="构建网络负载平衡群集(NLB) - 落花往事 - 落花往事" alt="构建网络负载平衡群集(NLB) - 落花往事 - 落花往事" src="http://ce.sysu.edu.cn/hope/Education/UploadFiles_5303/201001/20100113204301391.jpg" /></p> <p>　　图2</p> <p>　　用同样的方法为节点2安装Web服务器组件。</p> <br /> <p><strong>三、创建群集主机记录</strong></p> <p>　　在安装NLB群集之前建议先把DNS准备好，在本例中节点1同时也是网络中的DNS服务器。可以在节点1上为群集指派一个DNS名称，依次单击 “开始/所有程序/管理工具/DNS”，打开“dnsmagt”窗口。</p> <p>　　在左窗格中依次展开“ServerName/正向查找区域”目录。然后右击域名“cpcw.com”区域，执行“新建主机”快捷命令(如图 3)。</p> <p>　　</p> <p><img width="550" height="371" title="构建网络负载平衡群集(NLB) - 落花往事 - 落花往事" alt="构建网络负载平衡群集(NLB) - 落花往事 - 落花往事" src="http://ce.sysu.edu.cn/hope/Education/UploadFiles_5303/201001/20100113204302983.jpg" /></p> <p>　　图3</p> <p>　　在打开“新建主机”对话框  “名称”编辑框中键入一个自定义的群集名称(本例键入“Cluster”);在“IP地址”编辑框中键入准备该群集指派的静态IP地址(本例为  “10.115.223.10”)。单击“添加主机”按钮，很快就会提示已经成功创建了主机记录(如图4)。</p> <p>　　</p> <p><img width="347" height="300" title="构建网络负载平衡群集(NLB) - 落花往事 - 落花往事" alt="构建网络负载平衡群集(NLB) - 落花往事 - 落花往事" src="http://ce.sysu.edu.cn/hope/Education/UploadFiles_5303/201001/20100113204304650.jpg" /></p> <p>　　图4</p> <p><strong>四、在节点1上安装配置NLB</strong></p> <p>　　完成各项准备准备工作以后，就可以安装配置NLB群集了。对于两个节点而言，先在哪一个节点上安装配置NLB群集都是可以的。下面我们将在节点 1上进行安装配置。</p> <p>　　在节点1的桌面上右击“网上邻居”图标，打开“网络连接”窗口。然后右键单击“本地连接”图标，执行“属性”快捷命令，打开“本地连接  属性”对话框。</p> <p>　　观察“此连接使用下列项目”列表可以发现，默认情况下并没有选中“网络负载平衡”复选框。勾选该复选框(如图5)，然后单击“属性”按钮，打开  “网络负载平衡  属性”对话框。在“群集IP地址”区域，设置NLB群集IP地址为“10.115.223.10”，该地址供群
