title: UID,EUID,GID,EGID的关系
categories: [Linux]
tags: []
date: 2010-05-18 09:37:00
---
什么是UID,EUID,GID,EGID？<br />真正用户标识号（UID）：该标识号负责标识运行进程的用户。roor是0.<br />有效用户标识号（EUID）：该标识号负责标识以什么用户身份来给新创建的进程赋所有权、检查文件的存取权限和检查通过系统调用kill向进程发送软 中断信号的许可权限。我认为是EUID调用UID执行权限。<br />真正用户组标识号(GID)：负责标识运行进程的用户所属的组ID。<br />有效用户组标识号(EGID)：用来标识目前进程所属的用户组。可能因为执行文件设置set-gid位而与gid不同。<br /><p>每个用户有一个uid和gid, 这个记录在/etc/passwd,  /etc/group里面，每个文件有一个uid，  就是拥有这个文件的用户的uid。每个用户运行一个程序时是以自己的uid作为身份的，如果这个程序被设置了stick位，则这个程序以程序拥有者的 uid作为身份，程序运行时的这个身份(uid)就是euid,  表示这个程序以那个用户的身份运行（这样就拥有那个用户的权限，比如读取属于他的文件）。所以程序运行时的身份euid一般情况下都是运行这个程序的人的 uid，有时会是这个程序拥有者的uid。</p><p>以passwd程序为例，这个程序要写/etc/passwd,  /etc/shadow，一般用户对这些文件是没有写权限的，用户A运行了passwd，这个passwd进程的euid就是uidA，当要写这两个文件 时，passwd调用了setuid(seteuid?)，这样这个passwd进程的euid就是uidRoot了，passwd就可以写那两个文件 了，写完之后euid再切换成uidA.这个过程就实现了对/etc/passwd,  /etc/shadow的受控访问：普通用户只允许按照passwd程序定义好的方式修改这两个文件。</p><p>下面来看下这两个文件：</p><p>（1）/etc/passwd <br />功能：存放系统的用户帐号信息 <br />内 容：用户名　密码 UID GID 所属组用户主目录 SHELL <br />实例： u1 ： x ： 0 ： 0 ： u1 　　　  /home/u1　：/bin/bash</p><p>注：如果采用了shadow，此处存放口令的为屏蔽字符，真正密码保存在/etc/shadow中 。</p><p>如果不采用shadow，采用明文件显示，如果采用md5加密的话所存放的为密文。</p><p>（2）/etc/shadow</p><p>功能：存放用户口令（加密过的口令） <br />实例： u1 ： bq$# ： 10750： 0：  999 ：7 ： -1 ：-1 ： 12546 <br />说明： u1 用户名 <br />b1$# 加密的口令　　 <br />10750  从1970.1.1开始计算，该口令修改后已过去了多少天 <br />０　　　需要再过多少天这个口令可以被修改 <br />9999  密码的有效期 <br />7 口令失效多少天前发出警告 <br />-1 口令失效多少天之后禁用这个账户 <br />-1  口令从1970.1.1计算,该口令已经禁用了多少天 <br />12546 保留</p><p> </p><br />