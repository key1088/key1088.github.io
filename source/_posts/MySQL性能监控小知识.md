title: MySQL性能监控小知识
categories: [Linux]
tags: []
date: 2012-08-10 10:10:00
---
<p>MySQL性能监控小知识<br /><br />一，获取mysql用户下的进程总数<br /><br />ps&nbsp;-ef&nbsp;|&nbsp;awk&nbsp;&#39;{print&nbsp;$1}&#39;&nbsp;|&nbsp;grep&nbsp;&quot;mysql&quot;&nbsp;|&nbsp;grep&nbsp;-v&nbsp;&quot;grep&quot;&nbsp;|&nbsp;wc-1<br /><br />二，主机性能状态<br /><br />#&nbsp;uptime<br />[root@&nbsp;~]#&nbsp;uptime<br />13:05:52&nbsp;up&nbsp;53&nbsp;days,&nbsp;52&nbsp;min,&nbsp;&nbsp;1&nbsp;user,&nbsp;&nbsp;load&nbsp;average:&nbsp;0.00,&nbsp;0.00,&nbsp;0.00<br /><br />三，CPU使用率<br /><br />#&nbsp;top<br />或<br />#&nbsp;vmstat<br /><br />四，磁盘IO量<br /><br />#&nbsp;vmstat&nbsp;或&nbsp;#&nbsp;iostat<br />五，swap进出量[内存]<br /><br />#&nbsp;free<br />六，数据库性能状态<br />(1)QPS(每秒Query量)<br />QPS&nbsp;=&nbsp;Questions(or&nbsp;Queries)&nbsp;/&nbsp;seconds<br />mysql&nbsp;&gt;&nbsp;show&nbsp;/*50000&nbsp;global&nbsp;*/&nbsp;status&nbsp;like&nbsp;&#39;Question&#39;;<br /><br />(2)TPS(每秒事务量)<br />TPS&nbsp;=&nbsp;(Com_commit&nbsp;+&nbsp;Com_rollback)&nbsp;/&nbsp;seconds<br />mysql&nbsp;&gt;&nbsp;show&nbsp;status&nbsp;like&nbsp;&#39;Com_commit&#39;;<br />mysql&nbsp;&gt;&nbsp;show&nbsp;status&nbsp;like&nbsp;&#39;Com_rollback&#39;;<br /><br />(3)key&nbsp;Buffer&nbsp;命中率<br />key_buffer_read_hits&nbsp;=&nbsp;(1-key_reads&nbsp;/&nbsp;key_read_requests)&nbsp;*&nbsp;100%<br />key_buffer_write_hits&nbsp;=&nbsp;(1-key_writes&nbsp;/&nbsp;key_write_requests)&nbsp;*&nbsp;100%<br /><br />mysql&gt;&nbsp;show&nbsp;status&nbsp;like&nbsp;&#39;Key%&#39;;<br /><br />(4)InnoDB&nbsp;Buffer命中率<br />innodb_buffer_read_hits&nbsp;=&nbsp;(1&nbsp;-&nbsp;innodb_buffer_pool_reads&nbsp;/&nbsp;innodb_buffer_pool_read_requests)&nbsp;*&nbsp;100%<br /><br />mysql&gt;&nbsp;show&nbsp;status&nbsp;like&nbsp;&#39;innodb_buffer_pool_read%&#39;;<br /><br />(5)Query&nbsp;Cache命中率<br />Query_cache_hits&nbsp;=&nbsp;(Qcahce_hits&nbsp;/&nbsp;(Qcache_hits&nbsp;+&nbsp;Qcache_inserts&nbsp;))&nbsp;*&nbsp;100%;<br /><br />mysql&gt;&nbsp;show&nbsp;status&nbsp;like&nbsp;&#39;Qcache%&#39;;<br />(6)Table&nbsp;Cache状态量<br />mysql&gt;&nbsp;show&nbsp;status&nbsp;like&nbsp;&#39;open%&#39;;<br /><br />(7)Thread&nbsp;Cache&nbsp;命中率<br />Thread_cache_hits&nbsp;=&nbsp;(1&nbsp;-&nbsp;Threads_created&nbsp;/&nbsp;connections&nbsp;)&nbsp;*&nbsp;100%<br /><br />mysql&gt;&nbsp;show&nbsp;status&nbsp;like&nbsp;&#39;Thread%&#39;;<br /><br />mysql&gt;&nbsp;show&nbsp;status&nbsp;like&nbsp;&#39;Connections&#39;;<br /><br />(锁定状态<br />mysql&gt;&nbsp;show&nbsp;status&nbsp;like&nbsp;&#39;%lock%&#39;;<br /><br />(9)复制延时量<br />mysql&nbsp;&gt;&nbsp;show&nbsp;slave&nbsp;status<br /><br />(10)&nbsp;Tmp&nbsp;Table&nbsp;状况(临时表状况)<br />mysql&nbsp;&gt;&nbsp;show&nbsp;status&nbsp;like&nbsp;&#39;Create_tmp%&#39;;<br />(11)&nbsp;Binlog&nbsp;Cache&nbsp;使用状况<br />mysql&nbsp;&gt;&nbsp;show&nbsp;status&nbsp;like&nbsp;&#39;Binlog_cache%&#39;;<br /><br />(12)&nbsp;Innodb_log_waits&nbsp;量<br />mysql&nbsp;&gt;&nbsp;show&nbsp;status&nbsp;like&nbsp;&#39;innodb_log_waits&#39;;<br /><br />开源监控软件<br />一，RRDTool<br />二，Nagios<br />三，MRTG<br />四，Cacti<br /></p>