title: linux console的利用
categories: [Linux]
tags: []
date: 2011-01-19 17:12:00
---
<p>公司linux设备出现问题的时候，网络不同，没有办法操作。有的代理商，配置的ip都记不住，设备没有恢复出厂设备按钮。</p><p>以前只能接显示器，有的还要打开机箱盖，NND的麻烦啊。</p><p>&nbsp;</p><p>所以啊，想了一个办法，像配置交换机一样。使用console口，连接。配置。</p><p>开始网络寻找，找到了方法，给童鞋们分享一下。</p><p>&nbsp;</p><p>1.grup的配置/boot/grub/grub.conf</p><p># grub.conf generated by anaconda<br />#<br /># Note that you do not have to rerun grub after making changes to this file<br /># NOTICE:&nbsp; You do not have a /boot partition.&nbsp; This means that<br />#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; all kernel and initrd paths are relative to /, eg.<br />#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; root (hd1,0)<br />#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; kernel /boot/vmlinuz-version ro root=/dev/sdb1<br />#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; initrd /boot/initrd-version.img<br />#boot=/dev/sda<br />serial --unit=0 --speed=9600 --word=8 --parity=no --stop=1&nbsp;<br />terminal --timeout=10 serial console<br />default=0<br />timeout=5<br />#splashimage=(hd0,0)/boot/grub/splash.xpm.gz&nbsp;&nbsp;&nbsp;&nbsp; ####图像建议去掉<br />hiddenmenu<br />title Fedora Core (2.6.11-1.1369_FC4)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; root (hd0,0)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; kernel /boot/vmlinuz-2.6.11-1.1369_FC4 ro root=LABEL=/1 console=tty0 console=ttyS0,9600n8<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; initrd /boot/initrd-2.6.11-1.1369_FC4.img</p><p>&nbsp;</p><p>console在linux下是字符设备。ttys0.ttys1,ttys2......&nbsp; </p><p>tty0 是linux没有启动起来的时候，内核对应的接口（我自己理解是这样）</p><p>ttys0，则是linux console 的表示。</p><p>&nbsp;</p><p>2.修改/etc/inittab</p><p>[root@localhost etc]# cat /etc/inittab<br />#<br /># inittab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This file describes how the INIT process should set up<br />#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; the system in a certain run-level.<br />#<br /># Author:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Miquel van Smoorenburg, &lt;&gt;<br />#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Modified for RHS Linux by Marc Ewing and Donnie Barnes<br />#</p><p># Default runlevel. The runlevels used by RHS are:<br />#&nbsp;&nbsp; 0 - halt (Do NOT set initdefault to this)<br />#&nbsp;&nbsp; 1 - Single user mode<br />#&nbsp;&nbsp; 2 - Multiuser, without NFS (The same as 3, if you do not have networking)<br />#&nbsp;&nbsp; 3 - Full multiuser mode<br />#&nbsp;&nbsp; 4 - unused<br />#&nbsp;&nbsp; 5 - X11<br />#&nbsp;&nbsp; 6 - reboot (Do NOT set initdefault to this)<br />#<br />id:3:initdefault:</p><p># System initialization.<br />si::sysinit:/etc/rc.d/rc.sysinit</p><p>l0:0:wait:/etc/rc.d/rc 0<br />l1:1:wait:/etc/rc.d/rc 1<br />l2:2:wait:/etc/rc.d/rc 2<br />l3:3:wait:/etc/rc.d/rc 3<br />l4:4:wait:/etc/rc.d/rc 4<br />l5:5:wait:/etc/rc.d/rc 5<br />l6:6:wait:/etc/rc.d/rc 6</p><p># Trap CTRL-ALT-DELETE<br />ca::ctrlaltdel:/sbin/shutdown -t3 -r now</p><p># When our UPS tells us power has failed, assume we have a few minutes<br /># of power left.&nbsp; Schedule a shutdown for 2 minutes from now.<br /># This does, of course, assume you have powerd installed and your<br /># UPS connected and working correctly.<br />pf::powerfail:/sbin/shutdown -f -h +2 &quot;Power Failure; System Shutting Down&quot;</p><p># If power was restored before the shutdown kicked in, cancel it.<br />pr:12345:powerokwait:/sbin/shutdown -c &quot;Power Restored; Shutdown Cancelled&quot;</p><p><br /># Run gettys in standard runlevels<br />co:2345:respawn:/sbin/agetty ttyS0 9600 vt100-nav<br />1:2345:respawn:/sbin/mingetty tty1<br />2:2345:respawn:/sbin/mingetty tty2<br />3:2345:respawn:/sbin/mingetty tty3<br />4:2345:respawn:/sbin/mingetty tty4<br />5:2345:respawn:/sbin/mingetty tty5<br />6:2345:respawn:/sbin/mingetty tty6<br />s0:2345:respawn:/sbin/agetty -L -f /etc/issue.serial 9600 ttyS1 vt100</p><p><br /># Run xdm in runlevel 5<br />x:5:once:/etc/X11/prefdm -nodaemon<br />3. 修改/etc/securetty</p><p>tty安全设置，系统允许ttys0登录。添加ttyS0</p><p>[root@localhost etc]# cat /etc/securetty<br />console<br />vc/1<br />vc/2<br />vc/3<br />vc/4<br />vc/5<br />vc/6<br />vc/7<br />vc/8<br />vc/9<br />vc/10<br />vc/11<br />tty1<br />tty2<br />tty3<br />tty4<br />tty5<br />tty6<br />tty7<br />tty8<br />tty9<br />tty10<br />tty11<br />ttyS0<br /></p><p>然后用重启用putty或者SecureCRT。不建议用系统的超级终端，因为编辑文件的时候，无法编辑。</p><p>至少我没有找到方法。</p><p>我用的是putty</p><p><img src="/images/pic/3e38309389d3fcdda877a43a.jpg" small="0" /></p><p>ok 不懂的 童鞋可以留言。 加QQ交流。欢迎拍砖。。。<br /></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p>